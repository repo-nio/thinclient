<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<title></title>
		<script type="text/javascript" language="javascript" src="jsClient/NixxisClientScript.js"></script>
		<script type="text/javascript" language="javascript">
		    function onStateChanged(contactInfo)
		    {
		    }
		    
		    function initPage()
		    {
		        //document.domain = document.domain.substring(document.domain.lastIndexOf('.', document.domain.lastIndexOf('.') - 1) + 1);
		        NixxisClient.Init();
		        //window.parent.ClientLink.ContactStateChanged.Add(this, onStateChanged);
	        
		        setInterval(checkForMessages, 200);
		    }
		    
            var lastId = "";
            
            function checkForMessages(){
	            if(location.hash != lastId){
		            lastId = location.hash;
		            //console.log("Message Script: " + lastId);
		            alert("Message Script: " + lastId);
	            }
            }	           	    
		    function exitPage()
		    {
		        try
		        {
    		        window.parent.ClientLink.ContactStateChanged.Remove(this, onStateChanged);
		        }
		        catch(e)
		        {
		            ;
		        }
		    }

		    //--> Start debug functions
		    function Debug() { //debugger; }
		    function dbgDomainShow() { ConsoleMsg(document.domain); window.alert("CrScript: " + document.domain); }
	        function dbgDomainChange() { document.domain = "tommobiel"; }
	        function dbgAccessParent() { window.parent.dbgDomainShow(); } 
	        function dbgTestSendHashMsg()
	        {
                iwin = window.parent; 
                iwin.location = "http://tommobiel:8088/agent/crAgent.htm#uiMessageForScript_" + (new Date()).getTime();	    
	        }
	        function ConsoleMsg(text)
	        {
	            document.getElementById('output').innerHTML = text + "<br />" + document.getElementById('output').innerHTML;
	        }
	        function ConsoleClear()
	        {
	            document.getElementById('output').innerHTML = "&nbsp;";
	        }
		    //<-- Stop debug functions

		    //--> Start Nixxis contact center function
		    function SetUserInfo()
		    {
                document.getElementById('ContactId').innerHTML = NixxisClient.ContactId;
		        document.getElementById('UserId').innerHTML = NixxisClient.agent.UserAccount();
		        document.getElementById('UserName').innerHTML = NixxisClient.agent.UserName();		    
		    }
		    function Waitforall() { NixxisClient.commands.WaitForCall(); }
		    //<-- Stop Nixxis contact center function
		</script>
	</head>
	<body onload="javascript:initPage()" onunload="javascript:exitPage();" style="margin: 0px; border: solid 2px gray; font-family: Verdana, Sans-Serif; font-size: 10pt;">
        <table style="height:100%; width:100%">
            <tr>
                <td style="width:100%; height:300px;">
                    <div style=" border:solid 1px black; float:left; height:100%; padding:3px; overflow:auto;">
                        <h3>Debug</h3>
                        <input type="button" onclick="javascript: Debug();" value="Debug" /><br />
                        <input type="button" onclick="javascript: dbgDomainShow();" value="Show domainn name" /><br />
                        <input type="button" onclick="javascript: dbgDomainChange();" value="Change domain name" /><br />
                        <input type="button" onclick="javascript: dbgAccessParent();" value="Access parent" /><br />
                        <input type="button" onclick="javascript: dbgTestSendHashMsg();" value="Send msg" />
                    </div>
                    <div style=" border:solid 1px black; float:left; height:100%; padding:3px; overflow:auto;">
                        <h3>Contact center functions</h3>
                        <input type="button" onclick="javascript: SetUserInfo();" value="Set user info" /><br /><br />
                        <input type="button" onclick="javascript: Waitforall();" value="Wait all..." /><br />
                        
                    </div>
                    <div style=" border:solid 1px black; height:100%; padding:3px;">
                        <h3>User info</h3>
                        <span style="font-size:10px;">
                            ContactId: <span id='ContactId'></span><br />
                            UserId: <span id='UserId'></span><br />
                            User: <span id='UserName'></span><br />   
                        </span>                                             
                    </div>                
                </td>
            </tr>
            <tr>
                <td style="width:100%; height:100%">
                    <div id="output" style=" background-color: Black; color: Olive; width:100%; height:100%; overflow:auto">
                    &nbsp;
                    </div>                
                </td>
            </tr>
        </table>
	</body>
</html>
